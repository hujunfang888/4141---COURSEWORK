# 4141course-work-for-pca
conda env list
conda activate base
vcftools --version

#Search for files（ LAB_NEN_ODN.clean_BI.ann.vcf.gz） in the system
find ~/ -name "LAB_NEN_ODN.clean_BI.ann.3mbChr5.vcf.gz" 

#Switch to the directory where this file is located
cd "/Users/phoebe/Desktop/LIFE4141_coursework_resources 2024-2025-20241223/Data, helpful code and files"
#Create a population sampletxt
nano LAB_population.txt
LAB_004
LAB_1
LAB_2
LAB_300
LAB_4
LAB_400
LAB_5
LAB_500 

nano NEN_population.txt
NEN_001
NEN_003
NEN_200
NEN_300
NEN_4
NEN_5
NEN_6   
 
#run vcf
vcftools --gzvcf LAB_NEN_ODN.clean_BI.ann.3mbChr5.vcf.gz \
         --max-missing 0.8 \
         --maf 0.05 \
         --weir-fst-pop LAB_population.txt \
         --weir-fst-pop NEN_population.txt \
         --fst-window-size 5000 \
         --fst-window-step 5000 \
         --out LAB_vs_NENT_Fst
      
      
#Save the top 1% of the areas with high FST values：
awk 'NR>1 {print $1"\t"$2"\t"$3"\t"$5}' LAB_vs_NENT_Fst.windowed.weir.fst | sort -k4,4nr | head -n $(echo "$(wc -l < LAB_vs_NENT_Fst.windowed.weir.fst) * 0.01" | bc) > high_Fst_windows.bed

# Select a window with an FST value greater than 0.05 to extract a slightly higher FST area：
awk '$5 > 0.05 {print $1"\t"$2"\t"$3"\t"$5}' LAB_vs_NENT_Fst.windowed.weir.fst > high_Fst_windows.bed



#Alignment with genomic annotation files
#install bedtools
conda create -y --name bedtools -c bioconda bedtools
#procecing bedtools to find genes within the high FST windowby using annotation files 
bedtools intersect -a high_Fst_windows.bed -b C_excelsa_V5_braker2_wRseq.gff3 -wa -wb > candidate_genes.bed
